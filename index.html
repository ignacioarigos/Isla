<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8" />
  <title>Calendario de Asignaciones</title>
  <style>
    body {
      font-family: Segoe UI, Roboto, sans-serif;
      background-color: #f5f7fa;
      color: #333;
      display: flex;
      flex-direction: column;
      align-items: center;
      padding: 20px;
    }
    h1 {
      font-weight: 600;
      margin-bottom: 20px;
    }
    #controles {
      display: flex;
      gap: 20px;
      margin-bottom: 12px;
    }
    button {
      padding: 6px 12px;
      background-color: #ffa500;
      color: white;
      border: none;
      border-radius: 6px;
      cursor: pointer;
      font-weight: 500;
    }
    button:disabled {
      background-color: #ccc;
      cursor: not-allowed;
    }
    button:hover:not(:disabled) {
      background-color: #ff8c00;
    }
    #mes-actual {
      font-size: 18px;
      font-weight: 500;
      background: #fff3cd;
      padding: 6px 12px;
      border-radius: 6px;
    }
    table {
      border-collapse: collapse;
      background-color: #fff;
      box-shadow: 0 2px 6px rgba(0,0,0,0.1);
    }
    th, td {
      width: 40px;
      height: 40px;
      text-align: center;
      border: 1px solid #ccc;
    }
    td {
      cursor: pointer;
    }
    td:hover {
      background-color: #eee;
    }
    .highlight {
      font-weight: bold;
      color: white;
    }
    .eugenia  { background: linear-gradient(135deg, #bb86fc, #9e71e9); }
    .malvina  { background: linear-gradient(135deg, #2ecc71, #27ae60); }
    .ramon    { background: linear-gradient(135deg, #f7901e, #e85c00); }
    .enrique  { background: linear-gradient(135deg, #ff7f7f, #ff4f4f); }

    /* Conflictos visuales */
    .conflicto2 { background-color: #d1b2ff !important; border: 2px solid #a782e0; }
    .conflicto3 { background-color: #ffc0c0 !important; border: 2px solid #e06666; }
    .conflicto4 { background-color: #ffcc80 !important; border: 2px solid #e69500; }
    .conflictoX { background-color: #ccffcc !important; border: 2px solid #33aa33; }

    #asignado {
      margin-top: 16px;
      font-weight: 500;
      background-color: #fff8e1;
      padding: 8px 16px;
      border-radius: 8px;
      box-shadow: 0 1px 4px rgba(0,0,0,0.1);
    }
  </style>
</head>
<body>
  <h1>Calendario de Asignaciones</h1>
  <div id="controles">
    <button id="prevMes">◀︎ Anterior</button>
    <div id="mes-actual">Enero 2025</div>
    <button id="nextMes">Siguiente ▶︎</button>
  </div>
  <table id="calendario">
    <thead>
      <tr>
        <th>Do</th><th>Lu</th><th>Ma</th><th>Mi</th><th>Ju</th><th>Vi</th><th>Sa</th>
      </tr>
    </thead>
    <tbody></tbody>
  </table>
  <div id="asignado">Seleccioná una fecha para ver la asignación</div>

  <script>
    let fechaActual = new Date(2025, 0);
    const minFecha = new Date(2025, 0);
    const maxFecha = new Date(2026, 2);
    const colores = {
      eugenia: "eugenia",
      malvina: "malvina",
      ramon: "ramon",
      enrique: "enrique"
    };

    const bloque1 = [
      { inicio: "2025-01-02", fin: "2025-01-16", nombre: "vacaciones" },
      { inicio: "2025-01-17", fin: "2025-01-31", nombre: "eugenia" },
      { inicio: "2025-02-01", fin: "2025-02-15", nombre: "malvina" },
      { inicio: "2025-02-16", fin: "2025-03-02", nombre: "enrique" },
      { inicio: "2025-03-03", fin: "2025-03-16", nombre: "ramon" }
    ];

    const bloque3 = [
      { inicio: "2026-01-02", fin: "2026-01-16", nombre: "ramon" },
      { inicio: "2026-01-17", fin: "2026-01-31", nombre: "eugenia" },
      { inicio: "2026-02-01", fin: "2026-02-15", nombre: "malvina" },
      { inicio: "2026-02-16", fin: "2026-03-02", nombre: "enrique" }
    ];

    const bloque4 = [
      { inicio: "2025-07-19", fin: "2025-07-27", nombre: "ramon" },
      { inicio: "2025-07-28", fin: "2025-08-03", nombre: "malvina" }
    ];

    const bloque2 = [
      { inicio: "2025-03-08", fin: "2025-03-09", nombre: "enrique" },
      { inicio: "2025-03-15", fin: "2025-03-16", nombre: "ramon" },
      { inicio: "2025-03-22", fin: "2025-03-24", nombre: "eugenia" },
      { inicio: "2025-03-29", fin: "2025-03-30", nombre: "eugenia" },
      { inicio: "2025-04-05", fin: "2025-04-06", nombre: "malvina" },
      { inicio: "2025-04-12", fin: "2025-04-13", nombre: "enrique" },
      { inicio: "2025-04-19", fin: "2025-04-20", nombre: "ramon" },
      { inicio: "2025-04-26", fin: "2025-04-27", nombre: "eugenia" },
      { inicio: "2025-05-01", fin: "2025-05-04", nombre: "enrique" },
      { inicio: "2025-05-10", fin: "2025-05-11", nombre: "malvina" },
      { inicio: "2025-05-17", fin: "2025-05-18", nombre: "enrique" },
      { inicio: "2025-05-24", fin: "2025-05-25", nombre: "ramon" },
      { inicio: "2025-05-31", fin: "2025-06-01", nombre: "eugenia" },
      { inicio: "2025-06-07", fin: "2025-06-08", nombre: "malvina" },
      { inicio: "2025-06-14", fin: "2025-06-16", nombre: "ramon" },
      { inicio: "2025-06-20", fin: "2025-06-22", nombre: "malvina" },
      { inicio: "2025-06-28", fin: "2025-06-29", nombre: "enrique" },
      { inicio: "2025-07-05", fin: "2025-07-06", nombre: "ramon" },
      { inicio: "2025-07-12", fin: "2025-07-13", nombre: "eugenia" },
      { inicio: "2025-08-09", fin: "2025-08-10", nombre: "malvina" },
      { inicio: "2025-08-14", fin: "2025-08-15", nombre: "eugenia" },
      { inicio: "2025-08-23", fin: "2025-08-24", nombre: "enrique" },
      { inicio: "2025-08-30", fin: "2025-08-31", nombre: "ramon" },
      { inicio: "2025-09-06", fin: "2025-09-07", nombre: "eugenia" },
      { inicio: "2025-09-13", fin: "2025-09-14", nombre: "malvina" },
      { inicio: "2025-09-20", fin: "2025-09-21", nombre: "enrique" },
      { inicio: "2025-09-27", fin: "2025-09-28", nombre: "ramon" },
      { inicio: "2025-10-04", fin: "2025-10-05", nombre: "eugenia" },
      { inicio: "2025-10-11", fin: "2025-10-12", nombre: "malvina" },
      { inicio: "2025-10-18", fin: "2025-10-19", nombre: "enrique" },
      { inicio: "2025-10-25", fin: "2025-10-26", nombre: "ramon" },
      { inicio: "2025-11-01", fin: "2025-11-02", nombre: "eugenia" },
      { inicio: "2025-11-08", fin: "2025-11-09", nombre: "malvina" },
      { inicio: "2025-11-15", fin: "2025-11-16", nombre: "enrique" },
      { inicio: "2025-11-21", fin: "2025-11-24", nombre: "enrique" },
      { inicio: "2025-11-29", fin: "2025-11-30", nombre: "ramon" },
      { inicio: "2025-12-06", fin: "2025-12-08", nombre: "ramon" },
      { inicio: "2025-12-13", fin: "2025-12-14", nombre: "eugenia" },
      { inicio: "2025-12-20", fin: "2025-12-21", nombre: "malvina" },
      { inicio: "2025-12-27", fin: "2025-12-28", nombre: "enrique" }
    ];

    const tbody = document.querySelector("tbody");
    const mesActualElem = document.getElementById("mes-actual");
    const btnPrev = document.getElementById("prevMes");
    const btnNext = document.getElementById("nextMes");

    btnPrev.onclick = () => {
      fechaActual.setMonth(fechaActual.getMonth() - 1);
      if (fechaActual < minFecha) fechaActual = new Date(minFecha);
      dibujarMes(fechaActual);
    };

    btnNext.onclick = () => {
      fechaActual.setMonth(fechaActual.getMonth() + 1);
      if (fechaActual > maxFecha) fechaActual = new Date(maxFecha);
      dibujarMes(fechaActual);
    };

    function dibujarMes(fecha) {
      tbody.innerHTML = "";
      const año = fecha.getFullYear();
      const mes = fecha.getMonth();
      const primerDia = new Date(año, mes, 1);
      const ultimoDia = new Date(año, mes + 1, 0);
      const diaInicio = primerDia.getDay();
      const diasEnMes = ultimoDia.getDate();

      let fila = document.createElement("tr");
      for (let i = 0; i < diaInicio; i++) {
        fila.appendChild(document.createElement("td"));
      }

      for (let dia = 1; dia <= diasEnMes; dia++) {
        const celda = document.createElement("td");
        celda.textContent = dia;
        const fechaStr = `${año}-${(mes + 1).toString().padStart(2, '0')}-${dia.toString().padStart(2, '0')}`;
        celda.dataset.fecha = fechaStr;
        celda.onclick = () => seleccionarFecha(fechaStr);
        fila.appendChild(celda);

        if ((dia + diaInicio) % 7 === 0) {
          tbody.appendChild(fila);
          fila = document.createElement("tr");
        }
      }

      if (fila.hasChildNodes()) tbody.appendChild(fila);

      const nombreMes = fecha.toLocaleString("es-ES", { month: "long" });
      mesActualElem.textContent = `${nombreMes.charAt(0).toUpperCase() + nombreMes.slice(1)} ${año}`;
      actualizarBotones();
      limpiarColores();
      document.getElementById("asignado").textContent = "Seleccioná una fecha para ver la asignación";
    }

    function actualizarBotones() {
      btnPrev.disabled = fechaActual <= minFecha;
      btnNext.disabled = fechaActual >= maxFecha;
    }

    function seleccionarFecha(fechaStr) {
      limpiarColores();
      const fechaSeleccionada = new Date(fechaStr);
      let encontrado = false;

      for (const grupo of [bloque1, bloque3, bloque4]) {
        for (const r of grupo) {
          const inicio = new Date(r.inicio);
          const fin = new Date(r.fin);
          if (fechaSeleccionada >= inicio && fechaSeleccionada <= fin) {
            pintarRango(inicio, fin, r.nombre);
            document.getElementById("asignado").textContent = `Bloque asignado: ${capitalizar(r.nombre)} del ${formatear(inicio)} al ${formatear(fin)}`;
            encontrado = true;
            return;
          }
        }
      }

      for (const r of bloque2) {
        let inicio = new Date(r.inicio);
        let fin = new Date(r.fin);
        if (inicio > fin) [inicio, fin] = [fin, inicio];
        const jueves = obtenerJuevesAnterior(inicio);
        const miercoles = obtenerMiercolesSiguiente(fin);
        if (fechaSeleccionada >= jueves && fechaSeleccionada <= miercoles) {
          pintarRango(jueves, miercoles, r.nombre);
          document.getElementById("asignado").textContent = `Bloque 2: ${capitalizar(r.nombre)} asignado del ${formatear(jueves)} al ${formatear(miercoles)}`;
          encontrado = true;
          return;
        }
      }

      if (!encontrado) {
        document.getElementById("asignado").textContent = `No hay asignación para la fecha seleccionada`;
      }
    }

    function pintarRango(inicio, fin, nombre) {
      const celdas = document.querySelectorAll("td");
      for (const celda of celdas) {
        const f = celda.dataset.fecha;
        if (!f) continue;
        const fechaCelda = new Date(f);
        if (fechaCelda >= inicio && fechaCelda <= fin) {
          celda.classList.add("highlight", colores[nombre]);
        }
      }
    }

    function limpiarColores() {
      document.querySelectorAll("td").forEach(td =>
        td.classList.remove("highlight", "eugenia", "malvina", "ramon", "enrique", "conflicto2", "conflicto3", "conflicto4", "conflictoX")
      );
    }

    function obtenerJuevesAnterior(fecha) {
      const copia = new Date(fecha);
      while (copia.getDay() !== 4) copia.setDate(copia.getDate() - 1);
      return copia;
    }

    function obtenerMiercolesSiguiente(fecha) {
      const copia = new Date(fecha);
      while (copia.getDay() !== 3) copia.setDate(copia.getDate() + 1);
      return copia;
    }

    function formatear(fecha) {
      const d = fecha.getDate().toString().padStart(2, "0");
      const m = (fecha.getMonth() + 1).toString().padStart(2, "0");
      const y = fecha.getFullYear();
      return `${d}/${m}/${y}`;
    }

    function capitalizar(txt) {
      return txt.charAt(0).toUpperCase() + txt.slice(1);
    }

    dibujarMes(fechaActual);
  </script>
</body>
</html>
